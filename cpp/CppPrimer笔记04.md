#### 1 基础

##### 1.1 基础概念

函数调用也是一种特殊的运算符。

要理解复杂表达式，就要理解运算符的优先级、结合律，和运算对象的求值顺序。

小整数类型通常会被提升为较大的整数类型。

可以重载运算符，其包括运算对象的类型和返回值的类型，都是由该运算符定义的；但是运算对象的个数、运算符的优先级和结合律是无法改变的。

C++表达式要么是右值(rvalue)，要么是左值（lvalue），左值可以位于赋值语句的左侧，而右值则不能：

- 当一个对象被用作右值时，用的是对象的值（内容）；
- 当对象被用作左值的时候，用的是对象的身份（在内存中的位置）。

一个重要原则是：在需要右值的地方可以用左值代替，但是不能把右值当成左值（也就是位置）使用。下面是几种用到左值的运算符：

- 赋值运算需要一个（非常量）左值作为左侧的运算对象，得到的结果也仍然是一个左值；
- 取地址符作用于一个左值运算对象，返回一个指向该运算对象的指针，这个指针是一个右值；
- 内置解引用运算符、下标运算符、迭代器解引用运算符的求值结果都是左值；
- 内置类型和迭代器的递增和递减运算符作用于左值运算对象，前置版本所得结果也是左值。

使用`decltype`时：

- 如果表达式的求值结果是左值，`decltype`作用于该表达式（不是变量）得到一个引用类型；
- 如果表达式的求值结果是右值，则是一个指针。

如：

```cpp
int *p = 42;
decltype(*p) rp = *p;  // 解引用运算符生成左值，所以rp是int&引用类型；
decltype(&p) ip;       // 取地址符生成右值，所以ip类型是**p
```

##### 1.2 优先级和结合律

运算符满足左结合律表示，在运算符优先级相同的情况下，按照从左到右的顺序组合运算对象。

IO相关的运算符满足左结合律：

```cpp
cin >> v1 >> v2;  // 先读入v1，再读入v2
```

##### 1.3 求值顺序

优先级规定了运算对象的组合方式，但没有说明运算对象按照什么顺序求值，如

```cpp
int i = f1() * f2();
```

可以确定`f1`和`f2`会在执行乘法之前被调用，但无法知道是先调用`f1`还是先调用`f2`。

对于未指定执行顺序的运算符，若表达式指向并修改了同一对象，会引发错误并产生未定义的行为，如`<<`未明确规定何时以及如何对运算对象求值，则下面的表达式是未定义的：

```cpp
int i = 0;
cout << i << " " << ++i << endl;
```

有四种运算符明确规定了运算对象的求值顺序：

- 逻辑与(`&&`)：
- 逻辑或(`||`)：
- 条件运算符(`?:`)：
- 逗号运算符(`,`)：



#### 2 算数运算符



#### 11 类型转换







|                            运算符                            |                     功能                     | 使用方法 | 结合律 | 作用类型 | 返回类型 |      |                    备注                    |
| :----------------------------------------------------------: | :------------------------------------------: | :------: | :----: | :------: | :------: | :--: | :----------------------------------------: |
|                   `::`<br />`::`<br />`::`                   | 全局作用域<br />类作用域<br />命名空间作用域 |          |   左   |          |          |  1   |                                            |
|                             `.`                              |                   成员选择                   |          |   左   |          |          |  2   |            左右值随成员所属对象            |
|                             `->`                             |                   成员选择                   |          |   左   |          |   左值   |  2   |                                            |
|                             `[]`                             |                     下标                     |          |   左   |          |          |  2   |                                            |
|                             `()`                             |                   函数调用                   |          |   左   |          |          |  2   |                                            |
|                             `()`                             |                   类型构造                   |          |   左   |          |          |  2   |                                            |
|                             `++`                             |                 后置递增运算                 |          |   右   |   左值   |   右值   |  3   |             返回对象原始值副本             |
|                             `--`                             |                 后置递减运算                 |          |   右   |   左值   |   右值   |  3   |             返回对象原始值副本             |
|                           `typeid`                           |                    类型ID                    |          |   右   |          |          |  3   |                                            |
|                           `typeid`                           |                   运行时ID                   |          |   右   |          |          |  3   |                                            |
|                       `explicit cast`                        |                   类型转换                   |          |   右   |          |          |  3   |                                            |
|                             `++`                             |                 前置递增运算                 |          |   右   |   左值   |   左值   |  4   |                返回对象本身                |
|                             `--`                             |                 前置递减运算                 |          |   右   |   左值   |   左值   |  4   |                返回对象本身                |
|                             `~`                              |                    位求反                    |          |   右   |          |          |  4   |                                            |
|                             `!`                              |                    逻辑非                    |          |   右   |   右值   |   右值   |  4   |                                            |
|                             `-`                              |                   一元负号                   |          |   右   |   右值   |   右值   |  4   |                                            |
|                             `+`                              |                   一元正号                   |          |   右   |   右值   |   右值   |  4   |                                            |
|                             `*`                              |                    解引用                    |          |   右   |          |          |  4   |                                            |
|                             `&`                              |                    取地址                    |          |   右   |   左值   |   右值   |  4   |                                            |
|                             `()`                             |                   类型转换                   |          |   右   |          |          |  4   |                                            |
|                           `sizeof`                           |                   对象大小                   |          |   右   |          |          |  4   |                                            |
|                           `sizeof`                           |                   类型大小                   |          |   右   |          |          |  4   |                                            |
|                         `sizeof...`                          |                  参数包大小                  |          |   右   |          |          |  4   |                                            |
|                            `new`                             |                   创建对象                   |          |   右   |          |          |  4   |                                            |
|                           `new[]`                            |                   创建数组                   |          |   右   |          |          |  4   |                                            |
|                           `delete`                           |                   释放对象                   |          |   右   |          |          |  4   |                                            |
|                          `delete[]`                          |                   释放数组                   |          |   右   |          |          |  4   |                                            |
|                          `noexcept`                          |                 能否抛出异常                 |          |   右   |          |          |  4   |                                            |
|                            `->*`                             |              指向成员选择的指针              |          |   左   |          |          |  5   |                                            |
|                             `.*`                             |              指向成员选择的指针              |          |   左   |          |          |  5   |                                            |
|                             `*`                              |                     乘法                     |          |   左   |   右值   |   右值   |  6   |                                            |
|                             `/`                              |                     除法                     |          |   左   |   右值   |   右值   |  6   |                  向0取整                   |
|                             `%`                              |                     取余                     |          |   左   |   右值   |   右值   |  6   |               正负由左侧确定               |
|                             `+`                              |                     加法                     |          |   左   |   右值   |   右值   |  7   |                                            |
|                             `-`                              |                     减法                     |          |   左   |   右值   |   右值   |  7   |                                            |
|                             `<<`                             |                   向左位移                   |          |   左   |          |          |  8   |                                            |
|                             `>>`                             |                   向右位移                   |          |   左   |          |          |  8   |                                            |
|               `<`<br />`<=`<br />`>`<br />`>=`               |  小于<br />小于等于<br />大于<br />大于等于  |          |   左   |   右值   |   右值   |  9   |                                            |
|                        `==`<br />`!=`                        |               相等<br />不相等               |          |   左   |   右值   |   右值   |  10  |                                            |
|                             `&`                              |                     位与                     |          |   左   |          |          |  11  |                                            |
|                             `^`                              |                    位异或                    |          |   左   |          |          |  12  |                                            |
|                             `|`                              |                     位或                     |          |   左   |          |          |  13  |                                            |
|                             `&&`                             |                    逻辑与                    |          |   左   |   右值   |   右值   |  14  |                  短路求值                  |
|                             `||`                             |                    逻辑或                    |          |   左   |   右值   |   右值   |  15  |                  短路求值                  |
|                             `?:`                             |                     条件                     |          |   右   |          |          |  16  |                                            |
|                             `=`                              |                     赋值                     |          |   右   | 左侧左值 |   左值   |  17  |                                            |
| `*=`、`/=`、`%=`<br />`+=`、`-=`<br />`<<=`、`>>=`<br />`&=`、`|=`、`^=` |                   复合赋值                   |          |   右   |          |          |  18  | 复合运算符求值一次<br />普通运算符求值两次 |
|                           `throw`                            |                   抛出异常                   |          |   右   |          |          |  19  |                                            |
|                             `,`                              |                     逗号                     |          |   左   |          |          |  20  |                                            |

